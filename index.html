<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùïè Animal Posts</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            overflow: hidden;
            background-color: #000;
            color: white;
        }

        #tweet-container {
            display: flex;
            flex-direction: column;
            height: 100vh; /* Ensure full height for container */
            overflow-y: auto;
            scroll-snap-type: y mandatory;
        }

        .post {
            scroll-snap-align: start;
            flex: 1 0 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            height: 100vh; /* Ensure each tweet occupies full viewport height */
        }

        .twitter-tweet {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .twitter-tweet iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div id="tweet-container"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('data.csv')
                .then(response => response.text())
                .then(text => {
                    const lines = text.split('\n').filter(line => line.trim() !== '');
                    const tweetContainer = document.getElementById('tweet-container');

                    lines.forEach(line => {
                        const tweetDiv = document.createElement('div');
                        tweetDiv.className = 'post';
                        tweetDiv.innerHTML = line.trim();
                        tweetContainer.appendChild(tweetDiv);
                    });

                    // Load Twitter widgets script
                    const script = document.createElement('script');
                    script.src = 'https://platform.twitter.com/widgets.js';
                    script.async = true;
                    script.charset = 'utf-8';
                    document.body.appendChild(script);

                    // Adjust tweet dimensions after loading
                    setTimeout(() => {
                        $('.twitter-tweet').each(function() {
                            const iframe = $(this).find('iframe');
                            if (iframe.length) {
                                const doc = iframe[0].contentDocument || iframe[0].contentWindow.document;
                                $(doc).find('head').append($('#twitter-style'));
                            }
                        });
                    }, 2000);

                    // Set up IntersectionObserver to handle autoplay and pause
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            const iframe = entry.target.querySelector('iframe');
                            if (iframe) {
                                let src = iframe.getAttribute('src');
                                if (entry.isIntersecting) {
                                    if (!src.includes('autoplay=1')) {
                                        src += (src.includes('?') ? '&' : '?') + 'autoplay=1';
                                        iframe.setAttribute('src', src);
                                    }
                                } else {
                                    src = src.replace('&autoplay=1', '').replace('?autoplay=1', '');
                                    iframe.setAttribute('src', src);
                                }
                            }
                        });
                    }, { threshold: 0.75 });

                    document.querySelectorAll('.post').forEach(post => {
                        observer.observe(post);
                    });
                });
        });
    </script>
</body>
</html>
